define(['jquery','underscore','uiComponent','Magento_MediaGalleryUi/js/action/getDetails'],function($,_,Component,getDetails){'use strict';return Component.extend({defaults:{template:'Magento_MediaGalleryUi/image/image-details',modalSelector:'',imageDetailsUrl:'/media_gallery/image/details',images:[],tagListLimit:7,showAllTags:false,image:null,modules:{mediaGridMessages:'${ $.mediaGridMessages }'}},initObservable:function(){this._super().observe(['image','showAllTags']);return this;},showImageDetailsById:function(imageId){if(_.isUndefined(this.images[imageId])){getDetails(this.imageDetailsUrl,imageId).then(function(imageDetails){this.images[imageId]=imageDetails;this.image(this.images[imageId]);this.openImageDetailsModal();}.bind(this)).fail(function(message){this.addMediaGridMessage('error',message);}.bind(this));return;}
if(this.image()&&this.image().id===imageId){this.openImageDetailsModal();return;}
this.image(this.images[imageId]);this.openImageDetailsModal();},openImageDetailsModal:function(){var modalElement=$(this.modalSelector);if(!modalElement.length||_.isUndefined(modalElement.modal)){return;}
this.showAllTags(false);modalElement.modal('openModal');},closeImageDetailsModal:function(){var modalElement=$(this.modalSelector);if(!modalElement.length||_.isUndefined(modalElement.modal)){return;}
modalElement.modal('closeModal');},addMediaGridMessage:function(code,message){this.mediaGridMessages().add(code,message);this.mediaGridMessages().scheduleCleanup();},getTagText:function(tagText,tagIndex){return tagText+(this.image().tags.length-1===tagIndex?'':',');},showMoreImageTags:function(){this.showAllTags(true);},getValueUnsanitizedHtml:function(value){var usedIn='';if(_.isObject(value)){_.each(value,function(numberOfTimeUsed,moduleName){usedIn+=numberOfTimeUsed+' '+moduleName+'</br>';});return usedIn;}
return value;}});});